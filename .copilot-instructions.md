# Innovative Ideas SharePoint Application - Copilot Instructions

## Project Overview

This is a comprehensive React-based Innovative Ideas management application hosted on SharePoint. The application enables employees to submit innovative ideas, track their progress through approval workflows, and provides management dashboards for oversight and decision-making.

## Key Features

### Core Functionality
- **Idea Submission**: Employees can submit innovative ideas with descriptions, categories, and supporting details
- **Approval Workflow**: Multi-level approval process with approver dashboards and swipe-to-approve functionality
- **Idea Tracking**: Real-time status updates and progress tracking through the idea lifecycle
- **Discussion Threads**: Task-based discussions for each idea to facilitate collaboration
- **Management Dashboards**: KPI cards, idea trails, and comprehensive reporting

### User Interface
- **Futuristic Minimalistic Design**: Clean, modern UI with icon-based interactions
- **Responsive Layout**: Works across desktop and mobile devices
- **Microsoft Blue Branding**: Consistent with enterprise design standards
- **Dark/Light Theme Support**: User-preference based theming

### Technical Features
- **SharePoint Integration**: REST API integration with CSRF protection and retry logic
- **Secure Authentication**: Windows authentication with form digest validation
- **Offline Capability**: Service worker for offline functionality
- **Performance Monitoring**: Built-in performance tracking and analytics

## Technical Architecture

### Frontend Stack
- **React 19.2.0** with TypeScript for type safety
- **Vite 7.3.0** for fast development and optimized production builds
- **Bootstrap 5.3.8** for responsive UI components
- **Lucide React** for consistent iconography
- **Chart.js** for data visualization

### SharePoint Integration
- **Three SharePoint Lists**:
  - `innovative_ideas`: Main ideas list with custom fields
  - `ino_ideas_tasks`: Tasks list with IdeaId lookup
  - `innovative_idea_discussions`: Discussion board with TaskId lookup

### State Management
- **Context-based Architecture**: Hierarchical providers for different concerns
  - `ThemeProvider`: Theme and UI state management
  - `DataProvider`: API data and caching
  - `NotificationProvider`: Toast notifications and alerts
  - `UIProvider`: General UI state

### Security & Performance
- **SecureApiClient**: Custom API client with CSRF protection, retry logic, and rate limiting
- **Web Workers**: Background data loading for improved performance
- **CSS Modules**: Scoped styling to prevent conflicts
- **Jest Testing**: Unit and integration test coverage

## Project Structure

```
src/
├── components/
│   ├── common/           # Reusable UI components
│   │   ├── ErrorBoundary.tsx
│   │   ├── LoadingSpinner.tsx
│   │   ├── StatusBar.tsx
│   │   ├── Toast.tsx
│   │   ├── TopUtilityBar.tsx
│   │   └── UserProfile.tsx
│   └── control/          # Control-specific components
│       └── TopControlPanel.tsx
├── contexts/             # React Context providers
│   ├── AppProviders.tsx
│   ├── DataContext.tsx
│   ├── NotificationContext.tsx
│   ├── ThemeContext.tsx
│   └── UIContext.tsx
├── hooks/               # Custom React hooks
├── pages/               # Main application pages
│   ├── ApproverDashboard.tsx
│   ├── IdeaDetailPage.tsx
│   ├── IdeaFormPage.tsx
│   ├── MainDashboard.tsx
│   └── TaskDiscussionPage.tsx
├── services/            # API service layer
│   └── ideaApi.ts
├── styles/              # Global styles
│   └── index.css
├── types/               # TypeScript type definitions
│   └── index.ts
├── utils/               # Utility functions
│   ├── constants.tsx
│   ├── logger.ts
│   ├── performance.ts
│   ├── secureApi.ts
│   ├── security.ts
│   └── sharePointInit.ts
├── App.tsx             # Main application component
└── main.tsx           # Application entry point
```

## Development Setup

### Prerequisites
- Node.js 18+ and npm
- Access to SharePoint site at `http://hospp16srv:36156`
- Windows authentication credentials

### Installation
```bash
# Clone the repository
git clone <repository-url>
cd innovative_Idea_development

# Install dependencies
npm install

# Start development server
npm run dev
```

### Available Scripts
- `npm run dev` - Start development server
- `npm run build` - Build for production
- `npm run preview` - Preview production build
- `npm run test` - Run Jest tests
- `npm run lint` - Run ESLint

## SharePoint Configuration

### Required Lists
The application requires three SharePoint lists with specific configurations:

#### 1. Innovative Ideas List (`innovative_ideas`)
- **List Type**: Custom List
- **Fields**:
  - Title (Text) - Idea title
  - Description (Note) - Detailed description
  - Status (Choice): Draft, Submitted, Under Review, Approved, Rejected, Implemented
  - Priority (Choice): Low, Medium, High, Critical
  - Category (Choice): Process Improvement, Technology, Cost Reduction, Safety, Other
  - SubmittedBy (Person) - Auto-populated
  - SubmittedDate (DateTime) - Auto-populated
  - ApprovedBy (Person) - Set during approval
  - ApprovedDate (DateTime) - Set during approval

#### 2. Ideas Tasks List (`ino_ideas_tasks`)
- **List Type**: Tasks List (built-in)
- **Additional Fields**:
  - IdeaId (Lookup) - Links to innovative_ideas list
  - TaskType (Choice): Review, Implementation, Follow-up

#### 3. Idea Discussions (`innovative_idea_discussions`)
- **List Type**: Discussion Board
- **Additional Fields**:
  - TaskId (Lookup) - Links to ino_ideas_tasks list

### Document Library
- **innovativeIdeas**: Document library for hosting the application
- **Folder Structure**:
  ```
  innovativeIdeas/
  ├── dist/
  │   ├── index.html
  │   └── assets/
  │       ├── *.js
  │       └── *.css
  ```

## API Integration

### SecureApiClient
Located in `src/utils/secureApi.ts`, provides:
- CSRF protection with form digest
- Automatic retry logic with exponential backoff
- Rate limiting and throttling
- Error handling and logging

### IdeaApiService
Located in `src/services/ideaApi.ts`, provides:
- CRUD operations for ideas, tasks, and discussions
- Batch operations for efficiency
- Data transformation and validation

### Key API Endpoints
```typescript
// Ideas
GET /_api/web/lists/getbytitle('innovative_ideas')/items
POST /_api/web/lists/getbytitle('innovative_ideas')/items
PATCH /_api/web/lists/getbytitle('innovative_ideas')/items({id})

// Tasks
GET /_api/web/lists/getbytitle('ino_ideas_tasks')/items?$filter=IdeaId eq {ideaId}
POST /_api/web/lists/getbytitle('ino_ideas_tasks')/items

// Discussions
GET /_api/web/lists/getbytitle('innovative_idea_discussions')/items?$filter=TaskId eq {taskId}
POST /_api/web/lists/getbytitle('innovative_idea_discussions')/items
```

## Deployment Process

### Build Configuration
- **Vite Config**: Optimized for SharePoint hosting with minimal chunking
- **Base Path**: `/innovativeIdeas/dist/` for correct asset loading
- **Asset Handling**: Excludes SharePoint system folders

### Deployment Script
Located in `deploy-rest.ps1`:
```powershell
# Key configuration
$siteUrl = "http://hospp16srv:36156"
$targetFolder = "/innovativeIdeas/dist"
$assetsFolder = "$targetFolder/assets"
```

### Deployment Steps
1. Build the application: `npm run build`
2. Run deployment script: `.\deploy-rest.ps1`
3. Verify deployment at: `http://hospp16srv:36156/innovativeIdeas/dist/index.html`

## Code Patterns and Conventions

### Component Structure
```typescript
// Use functional components with hooks
const MyComponent: React.FC<Props> = ({ prop1, prop2 }) => {
  const [state, setState] = useState(initialState);

  // Custom hooks for complex logic
  const { data, loading } = useCustomHook();

  return (
    <div className={styles.container}>
      {/* Component JSX */}
    </div>
  );
};
```

### CSS Modules
```typescript
// component.module.css
.container {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

.title {
  color: var(--color-primary);
  font-weight: 600;
}

// component.tsx
import styles from './component.module.css';

const Component = () => (
  <div className={styles.container}>
    <h1 className={styles.title}>Title</h1>
  </div>
);
```

### Error Handling
```typescript
try {
  const result = await apiCall();
  // Handle success
} catch (error) {
  console.error('API Error:', error);
  // Show user-friendly error message
  showNotification('Failed to load data', 'error');
}
```

### State Management
```typescript
// Use context for global state
const useData = () => {
  const context = useContext(DataContext);
  if (!context) {
    throw new Error('useData must be used within DataProvider');
  }
  return context;
};

// Component usage
const MyComponent = () => {
  const { ideas, loadIdeas } = useData();

  useEffect(() => {
    loadIdeas();
  }, [loadIdeas]);

  return <div>{/* Render ideas */}</div>;
};
```

## Testing Guidelines

### Unit Tests
- Use Jest with React Testing Library
- Test component rendering and interactions
- Mock API calls and external dependencies
- Aim for 80%+ code coverage

### Integration Tests
- Test complete user workflows
- Verify API integration
- Test error scenarios

### Test Structure
```typescript
describe('IdeaForm', () => {
  it('submits idea successfully', async () => {
    render(<IdeaForm />, { wrapper: TestProviders });

    // Fill form
    fireEvent.change(screen.getByLabelText('Title'), {
      target: { value: 'Test Idea' }
    });

    // Submit
    fireEvent.click(screen.getByText('Submit'));

    // Verify API call
    await waitFor(() => {
      expect(mockApi.createIdea).toHaveBeenCalledWith({
        title: 'Test Idea',
        // ... other fields
      });
    });
  });
});
```

## Performance Considerations

### Optimization Techniques
- **Code Splitting**: Automatic chunking by Vite
- **Lazy Loading**: Route-based code splitting
- **Memoization**: React.memo for expensive components
- **Virtual Scrolling**: For large lists
- **Image Optimization**: WebP format with fallbacks

### Monitoring
- **Performance Metrics**: Track Core Web Vitals
- **Bundle Analysis**: Monitor bundle sizes
- **API Performance**: Track response times
- **Error Tracking**: Log and monitor errors

## Security Best Practices

### Authentication
- Windows authentication only
- No custom login forms
- Form digest validation for all API calls

### Data Protection
- Input validation and sanitization
- XSS protection through React's built-in escaping
- CSRF protection via SharePoint form digests

### API Security
- Rate limiting on API calls
- Error message sanitization
- Secure headers configuration

## Troubleshooting

### Common Issues

#### Build Errors
- **Missing dependencies**: Run `npm install`
- **TypeScript errors**: Check type definitions in `src/types/`
- **CSS module issues**: Verify file naming conventions

#### Deployment Issues
- **Authentication errors**: Verify Windows credentials
- **Permission errors**: Check SharePoint permissions
- **Path errors**: Verify folder structure in document library

#### Runtime Issues
- **API failures**: Check network connectivity and SharePoint availability
- **Asset loading errors**: Verify base path configuration
- **CORS errors**: Ensure proper SharePoint configuration

### Debug Mode
Enable debug logging by setting:
```typescript
localStorage.setItem('debug', 'true');
```

## Contributing Guidelines

### Code Style
- Use TypeScript for all new code
- Follow React best practices
- Use CSS modules for component styling
- Write descriptive commit messages

### Pull Request Process
1. Create feature branch from `main`
2. Implement changes with tests
3. Update documentation if needed
4. Submit PR with description
5. Code review and approval
6. Merge after CI passes

### Documentation Updates
- Update this file for architectural changes
- Add JSDoc comments for new functions
- Update README for user-facing changes

## Future Enhancements

### Planned Features
- [ ] Advanced search and filtering
- [ ] Idea voting system
- [ ] Automated notifications
- [ ] Analytics dashboard
- [ ] Mobile app companion
- [ ] Integration with other enterprise systems

### Technical Debt
- [ ] Migrate to React Query for better data fetching
- [ ] Implement proper error boundaries
- [ ] Add comprehensive end-to-end tests
- [ ] Optimize bundle size further
- [ ] Add internationalization support

---

## Quick Reference

### Important URLs
- **Development**: `http://localhost:5173`
- **Production**: `http://hospp16srv:36156/innovativeIdeas/dist/index.html`
- **SharePoint Site**: `http://hospp16srv:36156`

### Key Files
- `src/App.tsx` - Main application component
- `src/contexts/DataContext.tsx` - Data management
- `src/services/ideaApi.ts` - API integration
- `src/utils/secureApi.ts` - Secure API client
- `vite.config.js` - Build configuration
- `deploy-rest.ps1` - Deployment script

### Environment Variables
```bash
# No environment variables currently used
# All configuration is hardcoded for SharePoint environment
```

This document serves as a comprehensive guide for understanding, developing, and maintaining the Innovative Ideas SharePoint application. Keep it updated as the project evolves.